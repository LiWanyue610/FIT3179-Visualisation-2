{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": "Comparison of forest coverage in 2021 with the overall average",
  "data": {
    "url": "https://raw.githubusercontent.com/LiWanyue610/FIT3179-Visualisation-2/refs/heads/main/forest_coerage_clean.csv",
    "format": {"type": "csv"}
  },
  "width": 700,
  "height": {"step": 24},
  "layer": [
    {
      "transform": [
        {
          "joinaggregate": [
            {"op": "mean", "field": "forest_cover_rate_percentage", "as": "avg_2003_2021"}
          ],
          "groupby": ["name"]
        },
        {"filter": {"field": "date", "timeUnit": "year", "equal": 2021}}
      ],
      "mark": {"type": "bar", "tooltip": true, "cornerRadiusEnd": 3},
      "encoding": {
        "y": {"field": "name", "type": "nominal", "title": "States", "sort": "-x"},
        "x": {"field": "forest_cover_rate_percentage", "type": "quantitative", "title": "Forest Coverage (%)"},
        "color": {"field": "name", "type": "nominal", "title": "State", "scale": {"scheme": "tableau20"}},
        "tooltip": [
          {"field": "name", "type": "nominal", "title": "State:"},
          {"field": "forest_cover_rate_percentage", "type": "quantitative", "title": "Forest Coverage in 2021 (%):", "format": ".2f"},
          {"field": "avg_2003_2021", "type": "quantitative", "title": "Average Proportion 2003 - 2021 (%):", "format": ".2f"}
        ]
      }
    },
    {
  "transform": [
    {
      "aggregate": [
        {"op": "mean", "field": "forest_cover_rate_percentage", "as": "avg_2003_2021"}
      ],
      "groupby": ["name"]
    }
  ],
  "mark": {"type": "tick", "color": "red", "thickness": 3},
  "encoding": {
    "x": {"field": "avg_2003_2021", "type": "quantitative"},
    "y": {"field": "name", "type": "nominal"},
    "size": {"value": 20}, 
    "tooltip": [
      {"field": "name", "type": "nominal", "title": "State:"},
      {"field": "avg_2003_2021", "type": "quantitative", "title": "Average Proportion 2003 - 2021 (%):", "format": ".2f"}
    ]
  }
}
  ],
  "config": {
    "axis": {"labelFontSize": 12, "titleFontSize": 12},
    "bar": {"height": 14}
  }
}